{"version":3,"file":"main.js","mappings":"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","sources":["webpack://ahj_8_2_frontend/./src/js/Chat.js","webpack://ahj_8_2_frontend/./src/js/getCreationDate.js","webpack://ahj_8_2_frontend/./src/js/Tooltip.js","webpack://ahj_8_2_frontend/./src/js/RenderModal.js","webpack://ahj_8_2_frontend/./src/js/app.js"],"sourcesContent":["import getCreationDate from './getCreationDate';\n\nexport default class Chat {\n  constructor(container, activeUser) {\n    this.container = container;\n    this.activeUser = activeUser;\n  }\n\n  renderConnectionUser(user) {\n    const connectionContainer = document.querySelector('.connection-container');\n\n    const connectionRow = document.createElement('UL');\n    const liPreview = document.createElement('LI');\n    const connectionPreview = document.createElement('DIV');\n    const liUser = document.createElement('LI');\n    const connectionUser = document.createElement('P');\n\n    connectionRow.classList.add('connection-row');\n    connectionPreview.classList.add('connection-prewiew');\n    connectionUser.classList.add('connection-user');\n\n    if (user === this.activeUser) {\n      connectionUser.classList.add('you');\n      connectionUser.textContent = `${user} (You)`;\n\n      window.onbeforeunload = async () => {\n        const query = `subscriptions/${encodeURIComponent(this.activeUser)}`;\n        console.log(query);\n        fetch(`https://ahj-8-1-backend.onrender.com/${query}`, {\n          method: 'DELETE',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        });\n      };\n    } else {\n      connectionUser.textContent = user;\n    }\n\n    connectionContainer.appendChild(connectionRow);\n    connectionRow.append(liPreview);\n    liPreview.append(connectionPreview);\n    connectionRow.append(liUser);\n    liUser.append(connectionUser);\n  }\n\n  static removeDisconnectionUser(user) {\n    const connectionUserArray = Array.from(document.querySelectorAll('.connection-user'));\n\n    const removeUser = connectionUserArray.find((item) => item.textContent === user);\n    if (removeUser) {\n      removeUser.closest('.connection-row').remove();\n    }\n  }\n\n  async renderChat() {\n    const connectionContainer = document.createElement('DIV');\n\n    const chatContainer = document.createElement('DIV');\n    const chat = document.createElement('DIV');\n    const chatSend = document.createElement('FORM');\n    const chatMessage = document.createElement('INPUT');\n\n    chatContainer.classList.add('chat-container');\n    chat.classList.add('chat');\n    chatSend.classList.add('chat-send');\n    chatMessage.classList.add('chat-message');\n\n    chatMessage.placeholder = 'Type some text';\n\n    this.container.appendChild(chatContainer);\n    chatContainer.append(chat);\n    chatSend.append(chatMessage);\n    chatContainer.append(chatSend);\n\n    connectionContainer.classList.add('connection-container');\n    this.container.appendChild(connectionContainer);\n\n    this.messaging();\n\n    const request = fetch('https://ahj-8-1-backend.onrender.com/index/', {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n    const result = await request;\n\n    if (!result.ok) {\n      console.error('Ошибка');\n\n      return;\n    }\n\n    const json = await result.json();\n\n    if (json) {\n      json.forEach((item) => {\n        this.renderConnectionUser(item.nickname);\n      });\n    }\n\n    this.gettingUsers();\n  }\n\n  renderMessage(autor, text) {\n    const chat = document.querySelector('.chat');\n    const boxMessage = document.createElement('DIV');\n    const information = document.createElement('SPAN');\n    const message = document.createElement('P');\n\n    boxMessage.classList.add('message-container');\n    information.classList.add('message-information');\n    message.classList.add('message-text');\n\n    const dateCreate = getCreationDate();\n\n    if (autor === this.activeUser) {\n      boxMessage.classList.add('right-align');\n      information.classList.add('you-message');\n      information.textContent = `${autor} (You), ${dateCreate}`;\n      message.textContent = text;\n    } else {\n      information.textContent = `${autor}, ${dateCreate}`;\n      message.textContent = text;\n    }\n\n    chat.appendChild(boxMessage);\n    boxMessage.append(information);\n    boxMessage.append(message);\n  }\n\n  gettingUsers() {\n    const eventSource = new EventSource('https://ahj-8-1-backend.onrender.com/sse');\n\n    eventSource.addEventListener('open', (e) => {\n      console.log(e);\n\n      console.log('sse open');\n    });\n\n    eventSource.addEventListener('error', (e) => {\n      console.log(e);\n\n      console.log('sse error');\n    });\n\n    eventSource.addEventListener('message', (e) => {\n      console.log(e);\n      const { nickname, req } = JSON.parse(e.data);\n\n      if (req === 'add') {\n        this.renderConnectionUser(nickname);\n      }\n      if (req === 'remove') {\n        Chat.removeDisconnectionUser(nickname);\n      }\n\n      console.log('sse message');\n    });\n  }\n\n  messaging() {\n    const ws = new WebSocket('wss://ahj-8-1-backend.onrender.com/ws');\n\n    const chatMessage = document.querySelector('.chat-message');\n    const chatSend = document.querySelector('.chat-send');\n\n    chatSend.addEventListener('submit', (e) => {\n      e.preventDefault();\n\n      const message = {};\n\n      message.autor = this.activeUser;\n      message.text = chatMessage.value;\n\n      if (!message) return;\n      ws.send(JSON.stringify(message));\n      // ws.send('fdgtvchgvbhj');\n      chatMessage.value = '';\n    });\n\n    ws.addEventListener('open', (e) => {\n      console.log(e);\n\n      console.log('ws open');\n    });\n\n    ws.addEventListener('close', (e) => {\n      console.log(e);\n\n      console.log('ws close');\n    });\n\n    ws.addEventListener('error', (e) => {\n      console.log(e);\n\n      console.log('ws error');\n    });\n\n    ws.addEventListener('message', (e) => {\n      const data = JSON.parse(e.data);\n      const { chat: messages } = data;\n      messages.forEach((message) => {\n        const { autor } = JSON.parse(message);\n        const { text } = JSON.parse(message);\n\n        this.renderMessage(autor, text);\n      });\n\n      console.log('ws message');\n    });\n  }\n}\n","export default function getCreationDate() {\n  const date = new Date();\n  let dateHours = date.getHours();\n  let dateMinutes = date.getMinutes();\n  let dateDay = date.getDate();\n  let dateMonth = date.getMonth() + 1;\n  if (dateHours < 10) {\n    dateHours = `0${dateHours}`;\n  }\n  if (dateMinutes < 10) {\n    dateMinutes = `0${dateMinutes}`;\n  }\n  if (dateDay < 10) {\n    dateDay = `0${dateDay}`;\n  }\n  if (dateMonth < 10) {\n    dateMonth = `0${dateMonth}`;\n  }\n  return `${dateHours}:${dateMinutes} ${dateDay}.${dateMonth}.${date.getFullYear()}`;\n}\n","export default class Tooltip {\n  constructor() {\n    this._tooltips = [];\n  }\n\n  showTooltip(message, element) {\n    const tooltipElement = document.createElement('DIV');\n\n    tooltipElement.classList.add('form-error');\n    tooltipElement.textContent = message;\n\n    const id = performance.now();\n\n    this._tooltips.push({\n      id,\n      element: tooltipElement,\n    });\n\n    document.body.appendChild(tooltipElement);\n\n    const { right, top } = element.getBoundingClientRect();\n\n    tooltipElement.style.left = `${right + 5}px`;\n    tooltipElement.style.top = `${top + element.offsetHeight / 2 - tooltipElement.offsetHeight / 2}px`;\n    return id;\n  }\n\n  removeTooltip(id) {\n    const tooltip = this._tooltips.find((t) => t.id === id);\n\n    if (tooltip) {\n      tooltip.element.remove();\n    }\n\n    this._tooltips = this._tooltips.filter((t) => t.id !== id);\n  }\n\n  removeAllTooltip() {\n    this._tooltips.forEach((item) => item.element.remove());\n    this._tooltips = [];\n  }\n}\n","import Chat from './Chat';\nimport Tooltip from './Tooltip';\n\nexport default class RenderModal {\n  constructor(container) {\n    this.container = container;\n    this.tooltipFactory = new Tooltip();\n  }\n\n  enterUser() {\n    const modalContainer = document.createElement('DIV');\n    const titleModal = document.createElement('H1');\n    const formModal = document.createElement('FORM');\n    const inputModal = document.createElement('INPUT');\n    const buttonModal = document.createElement('BUTTON');\n\n    modalContainer.classList.add('modal-container');\n    titleModal.classList.add('modal-title');\n    formModal.classList.add('modal-form');\n    inputModal.classList.add('modal-input');\n    buttonModal.classList.add('modal-button');\n\n    formModal.setAttribute('novalidate', true);\n    inputModal.setAttribute('required', true);\n    inputModal.name = 'nickname';\n    inputModal.setCustomValidity('');\n\n    titleModal.textContent = 'Выберите псевдоним';\n    buttonModal.textContent = 'Продолжить';\n\n    this.container.appendChild(modalContainer);\n    modalContainer.append(titleModal);\n    formModal.append(inputModal);\n    formModal.append(buttonModal);\n    modalContainer.append(formModal);\n\n    let actualMessages = [];\n\n    const showTooltip = (message, el) => {\n      actualMessages.push({\n        name: el.name,\n        id: this.tooltipFactory.showTooltip(message, el),\n      });\n    };\n\n    formModal.addEventListener('submit', async (e) => {\n      e.preventDefault();\n\n      actualMessages.forEach((message) => this.tooltipFactory.removeTooltip(message.id));\n      actualMessages = [];\n\n      let request;\n      let result;\n      let json;\n\n      request = fetch('https://ahj-8-1-backend.onrender.com/index/', {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      RenderModal.generationLoading(modalContainer);\n\n      result = await request;\n\n      if (!result.ok) {\n        console.error('Ошибка');\n\n        return;\n      }\n\n      json = await result.json();\n\n      if (json) {\n        json.forEach((item) => {\n          if (item.nickname === inputModal.value) {\n            inputModal.setCustomValidity('customError');\n          } else {\n            inputModal.setCustomValidity('');\n          }\n        });\n      }\n\n      if (formModal.checkValidity()) {\n        const nickname = inputModal.value;\n\n        const chat = new Chat(this.container, nickname);\n\n        request = fetch('https://ahj-8-1-backend.onrender.com/subscriptions/', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({ nickname }),\n        });\n\n        result = await request;\n\n        if (!result.ok) {\n          console.error('Ошибка');\n\n          return;\n        }\n\n        json = await result.json();\n        const { status } = json;\n\n        if (status === 'OK') {\n          modalContainer.classList.add('display-none');\n          chat.renderChat();\n        }\n      } else {\n        const error = RenderModal.getError(inputModal);\n\n        if (error) {\n          showTooltip(error, inputModal);\n        }\n      }\n    });\n\n    const elementOnBlur = (e) => {\n      const el = e.target;\n\n      const error = RenderModal.getError(el);\n      if (error) {\n        showTooltip(error, el);\n      } else {\n        const currentErrorMessage = actualMessages.find((item) => item.name === el.name);\n\n        if (currentErrorMessage) {\n          this.tooltipFactory.removeTooltip(currentErrorMessage.id);\n        }\n      }\n\n      el.removeEventListener('blur', elementOnBlur);\n    };\n\n    inputModal.addEventListener('focus', () => {\n      inputModal.addEventListener('blur', elementOnBlur);\n    });\n  }\n\n  static getError(el) {\n    const spinner = document.querySelector('.loadingio-spinner-spinner-ugc4sg2wum');\n    if (spinner) {\n      spinner.remove();\n    }\n    const errors = {\n      nickname: {\n        valueMissing: 'Заполните, пожалуйста, поле \"Псевдоним\"',\n        customError: 'Пользователь с таким псевдонимом уже есть в чате, придумайте другой',\n      },\n    };\n\n    const errorKey = Object.keys(ValidityState.prototype).find((key) => {\n      if (!el.name) return null;\n      if (key === 'valid') return null;\n\n      if (el.validity[key]) console.log(key);\n\n      return el.validity[key];\n    });\n\n    if (!errorKey) return null;\n\n    return errors[el.name][errorKey];\n  }\n\n  static generationLoading(container) {\n    if (!document.querySelector('.loadingio-spinner-spinner-ugc4sg2wum')) {\n      const imageContainer = document.createElement('DIV');\n      const animation = document.createElement('DIV');\n\n      imageContainer.classList.add('loadingio-spinner-spinner-ugc4sg2wum');\n      animation.classList.add('ldio-7nr8cpu8w2k');\n\n      container.appendChild(imageContainer);\n      imageContainer.append(animation);\n      for (let i = 12; i !== 0; i -= 1) {\n        animation.append(document.createElement('DIV'));\n      }\n    }\n  }\n}\n","import RenderModal from './RenderModal';\n\nconst container = document.querySelector('.app-container');\nconst render = new RenderModal(container);\n\nrender.enterUser();\n"],"names":["Chat","constructor","container","activeUser","this","renderConnectionUser","user","connectionContainer","document","querySelector","connectionRow","createElement","liPreview","connectionPreview","liUser","connectionUser","classList","add","textContent","window","onbeforeunload","async","query","encodeURIComponent","console","log","fetch","method","headers","appendChild","append","static","removeUser","Array","from","querySelectorAll","find","item","closest","remove","chatContainer","chat","chatSend","chatMessage","placeholder","messaging","request","result","ok","error","json","forEach","nickname","gettingUsers","renderMessage","autor","text","boxMessage","information","message","dateCreate","date","Date","dateHours","getHours","dateMinutes","getMinutes","dateDay","getDate","dateMonth","getMonth","getFullYear","getCreationDate","eventSource","EventSource","addEventListener","e","req","JSON","parse","data","removeDisconnectionUser","ws","WebSocket","preventDefault","value","send","stringify","messages","Tooltip","_tooltips","showTooltip","element","tooltipElement","id","performance","now","push","body","right","top","getBoundingClientRect","style","left","offsetHeight","removeTooltip","tooltip","t","filter","removeAllTooltip","RenderModal","tooltipFactory","enterUser","modalContainer","titleModal","formModal","inputModal","buttonModal","setAttribute","name","setCustomValidity","actualMessages","el","generationLoading","checkValidity","status","renderChat","getError","elementOnBlur","target","currentErrorMessage","removeEventListener","spinner","errorKey","Object","keys","ValidityState","prototype","key","validity","valueMissing","customError","imageContainer","animation","i"],"sourceRoot":""}